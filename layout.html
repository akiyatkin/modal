{start:}
<style>
	/*Надо чтобы не моргал вставленный html в начале. Окно видимым на мгновение показывается в ff*/
	.popupmodal {
		visibility: hidden;
		position: fixed;
	}
</style>
<section class="popupmodal" role="dialog">
	<div class="body">
	<button aria-label="Закрыть" class="closemodal close">&times;</button>
{end:}
	</div>
	<div style="user-select: none">&nbsp;<!-- 2/3 экрана --></div>
</section>
<script type="module">
	import { Modal } from "/vendor/akiyatkin/modal/Modal.js"
	const div = document.getElementById('{div}')
	const cls = (cls, el = div) => el.getElementsByClassName(cls)
	const modal = cls('popupmodal')[0]
	const body = cls('body', modal)[0]
	const close = cls('close')[0]
	if (close) close.addEventListener('click', () => {
		Modal.hide(div)
	})
	document.body.addEventListener('click', e => {
		let el = e.target
		const path = [el]
		while (el && el.parentElement) path.push(el = el.parentElement)
		if (path.find(el => el.tagName == 'A')) return Modal.hide(div); //Клик по ссылке закрываем
		if (path.find(el => el == body)) return; //Клик внутри меню, меню не сворачивает
		Modal.hide(div)
	}, true);
	document.body.addEventListener('keydown', e => {
	    if (e.keyCode !== 27) return
	    Modal.hide(div)
	});
</script>